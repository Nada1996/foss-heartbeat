#mozilla/node-firefox\issue-50207735\comment-64683895.json . 
This is obscenely useful! :+1:.

r+ (though remove the locale bits from the URLs plz :-))

.
#mozilla/node-firefox\issue-50207735\comment-64684969.json . 
oh agh I didn't see the urls bit-I'll update it

.
#mozilla/node-firefox\issue-50207735\issue-50207735.json . 
r? @tofumatt

.
#mozilla/node-firefox\issue-50207735\pr-25101705.json . 
r? @tofumatt

.
#mozilla/node-firefox\issue-50207735\pr-comment-20951090.json . 
These URLs should all omit the inline-code bit.

.
#mozilla/node-firefox\issue-50305879\comment-64807800.json . 
:+1: ¡gracias! The non-anglos will :heart: you.

.
#mozilla/node-firefox\issue-50305879\issue-50305879.json . 
microchange but r? @tofumatt please? :D

.
#mozilla/node-firefox\issue-50305879\pr-25159886.json . 
microchange but r? @tofumatt please? :D

.
#mozilla/node-firefox\issue-52387336\comment-67515443.json . 
r+, though I don't get that empty merge commit.

.
#mozilla/node-firefox\issue-52387336\issue-52387336.json . 
@tofumatt r?

.
#mozilla/node-firefox\issue-52387336\pr-26313797.json . 
@tofumatt r?

.
#mozilla/node-firefox\issue-52388136\comment-69380079.json . 
It's sad that bug 942756 never landed, but it's a large patch set that I feel like is unlikely to revive.

I filed another bug to do only what's required here.

.
#mozilla/node-firefox\issue-52388136\comment-69874190.json . 
The new bug landed "--start-debugger-server" in Firefox 37.

.
#mozilla/node-firefox\issue-52388136\issue-52388136.json . 
Currently to enable remote debugging you have to open the developer console and type inline-code

This makes it impossible to run functional tests as we cannot launch Firefox and have it run on an specific port.

The solution would be to be able to:.

block-code.

there was some work going on this already: URL.

.
#mozilla/node-firefox\issue-52397349\comment-67529576.json . 
Haha, awesome.

.
#mozilla/node-firefox\issue-52397349\issue-52397349.json . 
... deploy apps

(bad) ASCII ART!

.
#mozilla/node-firefox\issue-52397349\pr-26319902.json . 
... deploy apps

(bad) ASCII ART!

.
#mozilla/node-firefox\issue-53901822\comment-70082621.json . 
Yeah, that's because I was analysing the old status! Once we get all the new modules in place we can update it! That should be soon. I'll take this bug!

.
#mozilla/node-firefox\issue-53901822\issue-53901822.json . 
The dependency diagram in the README uses the old "fxos" module names, which make the project seem like it's not meant for desktop Firefox too.

We should update the diagram to match the new modules.

.
#mozilla/node-firefox\issue-54447687\comment-70088838.json . 
:+1: guidelines are very important. I'd advise putting them in a CONTRIBUTING.md file rather than README.md.

This has two advantages:.
1. Keep the user doc separate from contributor doc, avoid overloading README.
2. GitHub will add a "Read the guidelines for contributing first" in any PR sent to this repo  :)

## Matti Schneider

Sent from a phone, please excuse the terseness.

Le 15 janv. 2015 à 14:14, sole notifications@github.com a écrit :.
















.
#mozilla/node-firefox\issue-54447687\comment-70103911.json . 
A+ and +1 to @MattiSG for outlining this in a contributing file

.
#mozilla/node-firefox\issue-54447687\comment-70110406.json . 
I guess the short version is I'm all for this and also agree that a lot of it belongs in a contributing file. Yay :+1: 

.
#mozilla/node-firefox\issue-54447687\comment-70243841.json . 
Resolved via URL.

.
#mozilla/node-firefox\issue-54447687\issue-54447687.json . 
I'm thinking of adding these guidelines to the README as a new section so we are all on the same page. It's a way of formalising/dumping the knowledge we've acquired while tidying up the first two modules. Did I forget anything? @tofumatt @brittanystoroz 

1) remove as many dependencies as possible and make the code super simple. Right now it is using underscore and Q and the code looks too cryptic unless you're familiar with those. So far using es6-promise and Promise.all has got me covered.

2) Try to be as obvious as possible. This means, for example, not using "B2G" if we can say "simulator" instead. Another example from this module: inline-code can be renamed to inline-code and it is so much evident what it is doing for someone who is not familiar with the moz-jargon.

3) Only expose the API via promises. Granted you internally might need to use callbacks for other modules which are not promisified, but we want to make the whole API follow the same style, so once you learn to use one module, using another node-firefox- module is easy because the interface is the same: inline-code.

4) No CLI binary. None of the existing examples/use cases we came up with were using the CLI, so there's either no need for that or we hate the CLI. Either way there was a lot of duplicated code between modules for doing CLI and it wasn't too consistent, and we do not have too much time for this first iteration, so no CLI for now.

5) For naming, try to be as generic as possible but also as semantic as possible. For example, if a module can be used to discover firefox and firefox OS runtimes, try to avoid adding 'os' to its name, so that it is more generic. Also consider if something sounds weird, maybe it's because we're using the wrong name. E.g. inline-code sounded weird until it was renamed to inline-code. When in doubt, discuss it with more people! Don't be afraid :D (specially if English is not your first language!)

6) Use the build-tools module and gulpfile.js to lint the code.

.
#mozilla/node-firefox\issue-54481886\comment-70133864.json . 
Added some of my own tweaks in #9, r?

.
#mozilla/node-firefox\issue-54481886\issue-54481886.json . 
Let's use this to get the contributing ball rolling! @tofumatt r?

.
#mozilla/node-firefox\issue-54481886\pr-27448167.json . 
Let's use this to get the contributing ball rolling! @tofumatt r?

.
#mozilla/node-firefox\issue-54484465\comment-70137242.json . 
lgtm

.
#mozilla/node-firefox\issue-54484465\comment-70244798.json . 
I love it!

.
#mozilla/node-firefox\issue-54484465\issue-54484465.json . 
Excellent!

I made some tweaks of my own, thoughts?

.
#mozilla/node-firefox\issue-54484465\pr-27449717.json . 
Excellent!

I made some tweaks of my own, thoughts?

.
#mozilla/node-firefox\issue-54484814\comment-70261560.json . 
Yeah I mean this module doesn't have much (none?) actual code, but yes, let's have the same license in all!

.
#mozilla/node-firefox\issue-54484814\issue-54484814.json . 
Is this code supposed to be MPL or Apache-licensed? A lot of the modules are Apache and that seems to be a better fit for node (also it's way more straightforward, copyleft is confusing).

Should we change the node-firefox license to Apache 2.0?

.
#mozilla/node-firefox\issue-55014366\comment-70837455.json . 
This is a good idea! I would expect the start-simulator module to have a
way to stop things myself, though admittedly your proposal is a better API
than what I can think up if it were part of the same module!

I agree, we should have a way to easily stop things too.

-tofumatt
On 21 Jan 2015 07:51, "sole" notifications@github.com wrote:.































.
#mozilla/node-firefox\issue-55014366\comment-73685253.json . 
For now you can just do something on these lines instance.client.close() process.kill(instance.pid)

.
#mozilla/node-firefox\issue-55014366\issue-55014366.json . 
I know it sounds "so simple" but it might hide complexity and prevent platform differences and that IS GOOD.

Right now for stopping a simulator in Mac OS (and Linux I hope) you need to know the process id (PID), then you just use inline-code to kill the process. If you have enough privileges (i.e. you started it, which is often the case, or have superprivileges) you kill it. Example.

But it is maybe exposing too much of the "internals", and they might also be different in Windows. It might be neat to be able to have this module so you can do things like this:.

block-code.

We're not exposing 'pid' at any point! And we get more promises!

.
#mozilla/node-firefox\issue-55020034\comment-70839273.json . 
Related and good read: URL.

highlight: 





.
#mozilla/node-firefox\issue-55020034\comment-70841826.json . 
Everything regarding SemVer is at semver.org.

For tagging, just use inline-code  :)

.
#mozilla/node-firefox\issue-55020034\issue-55020034.json . 
I always forget to inline-code modules when I publish them-I do remember to update package.json because otherwise npm tells me no way I'm publishing it again. There are tools for doing this automatically, perhaps even publishing to npm afterwards.

Let's use this issue to explore these tools!

.
#mozilla/node-firefox\issue-55023332\comment-72007182.json . 
URL.

.
#mozilla/node-firefox\issue-55023332\issue-55023332.json . 
Just as we'll have inline-code and inline-code (formerly inline-code). It feels like a natural feature to have!

.
#mozilla/node-firefox\issue-55540159\comment-71543919.json . 
:laughing: :fearful: :boom: 

.
#mozilla/node-firefox\issue-55540159\issue-55540159.json . 
Les jokingly raised an interesting issue without even wanting to: how many apps can the phone accept until it collapses in appularity?

It might be interesting to find out by repeatedly installing an app until it breaks. Maybe there's no limit. Maybe the limit is whatever the storage accepts. This may be a lot when running on a simulator!

.
#mozilla/node-firefox\issue-55542081\comment-71545924.json . 
In general I like the idea that we can pass simple JS objects around. Seems this would either be a behind-the-scenes increase in complexity (converting objects to fancyObjects) or would require making a new Simulator() instead of just calling a function.

I’m not religiously opposed to the idea or anything. I can see what you mean and how it might actually be a lot better, but I’d want to see a real-world example of how it would reduce code complexity before I would say it’s a good idea. :-)

-tofumatt

On 26 January 2015 at 16:45:15, sole (notifications@github.com) wrote:.

We often handle the same type of "objects" when using modules in this project. They're sometimes not actual classes but just simple Objects with the same set of consistent attributes all over. A thought that often passes my mind is whether we should elevate them to their own class so we can say in the API "This call returns an object of class XYZ".

Or whether we should maybe use those objects instead of some of their properties, and hide them in the most generic case.

For example, if start-simulator would return an instance of Simulator option instead of returning a simple object, then we could also pass said instance to connect, instead of passing a port number, which requires you to know the name of the field (.port).

I have to write other modules now but I wanted to leave this here before I forget or move to another thing. I might come back with more thoughts/examples. Feel free to discuss/tell me why/if I'm wrong here :-)

—
Reply to this email directly or view it on GitHub.

.
#mozilla/node-firefox\issue-55542081\comment-71550564.json . 
If you have shared objects with shared _behavior_, consider putting them in their own class and packaging the class as a module that all dependents will import.

If you're just passing around _structured data_, then you're only using inline-code as a map, and you'll be better off using a documented POJO, as that will make serialization completely painless, saving you time when you want to transfer that data over the wire (which will inevitably happen at some point).

.
#mozilla/node-firefox\issue-55542081\issue-55542081.json . 
We often handle the same type of "objects" when using modules in this project. They're sometimes not actual classes but just simple inline-code with the same set of consistent attributes all over. A thought that often passes my mind is whether we should _elevate_ them to their own class so we can say in the API "This call returns an object of class XYZ".

Or whether we should maybe use those objects instead of some of their properties, and hide them in the most generic case.

For example, if inline-code would return an instance of inline-code option instead of returning a simple object, then we could also pass said instance to inline-code, instead of passing a port number, which requires you to know the name of the field (inline-code).

I have to write other modules now but I wanted to leave this here before I forget or move to another thing. I might come back with more thoughts/examples. Feel free to discuss/tell me why/if I'm wrong here :-)

.
#mozilla/node-firefox\issue-55612858\comment-111578091.json . 
FWIW, I've started hacking on this and #17 over here: URL.

.
#mozilla/node-firefox\issue-55612858\comment-117291557.json . 
Should it be added to the list and this bug closed?

.
#mozilla/node-firefox\issue-55612858\comment-117296660.json . 
I'll try to get some docs written this week, and then it might be worth encouraging folks to use it

.
#mozilla/node-firefox\issue-55612858\comment-117562399.json . 
"Assom"!

.
#mozilla/node-firefox\issue-55612858\issue-55612858.json . 
Building on the existing fxos-console module

.
#mozilla/node-firefox\issue-55612940\issue-55612940.json . 
Building on the existing console-logs module

.
#mozilla/node-firefox\issue-55613010\comment-72106568.json . 
doesn't actually build that much on the existing module, but URL.

.
#mozilla/node-firefox\issue-55613010\issue-55613010.json . 
Building on the existing reload-css module

.
#mozilla/node-firefox\issue-55613347\comment-71650239.json . 
Alex told me: 



.
#mozilla/node-firefox\issue-55613347\comment-73081726.json . 
+1 would love to have this!

.
#mozilla/node-firefox\issue-55613347\comment-73390725.json . 
Would love to see this integrate with unit tests and such <3

.
#mozilla/node-firefox\issue-55613347\comment-73684592.json . 
++1

.
#mozilla/node-firefox\issue-55613347\issue-55613347.json . 
Not sure which actor implements this (or if said actor is in simulators/phones!)-will add more info as I ask around.

.
#mozilla/node-firefox\issue-56058092\comment-72234528.json . 
If you’re finding the Promises are swallowing up too many errors, a common fix is to change:.

block-code.

to:.

block-code.

We do this in localForage and it prevents promise errors inside library code (which is what I assume you're hitting) from being "swallowed" by the Promises lib.

.
#mozilla/node-firefox\issue-56058092\comment-72234820.json . 
Related: this is probably good practice to convert to anyway, and maybe I can inspect linting code to look for this type of Promise implementation in our code. Users shouldn't have to write promises this way, but our code should.

It's mildly annoying at first, when dealing with the otherwise pleasant Promises API, to run into this :unamused: 

.
#mozilla/node-firefox\issue-56058092\comment-72237372.json . 
Yeah, I am using catch in places but the errors are not bubbling up often - because probably the chain of promises is not being returned. I am not sure that linting is going to solve this, it requires looking at the code by a human :-P

Also, the second argument to inline-code is not an exception but a inline-code which should not throw.

.
#mozilla/node-firefox\issue-56058092\comment-72240788.json . 
Right, but if I understand the chain correctly that means we aren't doing inline-code all the way up our Promises chain so somewhere the error is hidden...

URL.

That would mean having to wrap the inline-code bit in a inline-code block to prevent the Promise lib from catching the error, if I follow correctly.

.
#mozilla/node-firefox\issue-56058092\issue-56058092.json . 
While Promises are cool etc they also capture errors in a sneaky way and sometimes it's impossible to find where your error is unless you delve into the code and start console.logging like silly. 

For example I was passing a wrong parameter to inline-code and the promise was capturing the error in getWebAppsActor call, which overall remained silent. We should review the flow of each function and make sure errors can bubble up (perhaps intentionally building errors!)

This is probably due to my own lack of experience with promises so I accept all fault already :-)

.
#mozilla/node-firefox\issue-56718897\comment-73684946.json . 
If you want to have the developer tools, the one you are used to see in the Firefox Browser, then you can use WebIDE and set it to connect to the port where you started the simulator with node-firefox.

WebIDE -> Select runtime (top right corner) -> remote runtime and you set the same port.

.
#mozilla/node-firefox\issue-56718897\issue-56718897.json . 
Sorry if this is obvious, but it wasn't quite clear to me after reading URL how to connect a debugger (i.e. devtools) to a simulator started by node-firefox. Do I still need the webIDE to do this?

.
#mozilla/node-firefox\issue-56725363\issue-56725363.json . 
Verified start-simulator module works in Linux after updating binary paths here URL.

.
#mozilla/node-firefox\issue-56725363\pr-28758807.json . 
Verified start-simulator module works in Linux after updating binary paths here URL.

.
#mozilla/node-firefox\issue-56732367\comment-73132585.json . 
NB: currently, that script expects splashpack to be checked out in the same parent folder as owascan

.
#mozilla/node-firefox\issue-56732367\comment-86647440.json . 
I haven't found any error when launching 2.2 simulators. Perhaps you might want to make a smaller test case and attach any logging you can? When you start the simulator you can also pass in the inline-code option to get the output from the simulator being piped to stdout:.

block-code.

.
#mozilla/node-firefox\issue-56732367\issue-56732367.json . 
I've written a script that instantiates @louisstow 's splashpack and then launches it using node-firefox. This works for 2.2 simulator but not 2.0 simulator.

Script is at URL.

.
#mozilla/node-firefox\issue-57097298\comment-73679292.json . 
Yeah, I'd use that feature too!

@arcturus You did some work on adb+node. Do you think we could use it? My idea was this, you tell me if it could work:.
- Using adb.js (supposing it's called like that) we detect a device
- We can then set up port forwarding to localhost:someport
- Once we have this port listening we can use node-firefox-connect

Does it make sense?

.
#mozilla/node-firefox\issue-57097298\comment-73679630.json . 
Expanding more on this:.
- We could have a inline-code module, returning the device ids that adb detects
- Then a inline-code or similar module using the device ids found above? Edit: maybe we also need a module to unset the forwarding

What is cool about this is that _we could push to all the connected devices_!!!

!!!

.
#mozilla/node-firefox\issue-57097298\comment-73684438.json . 
I can't find other conversations where I mentioned this, but this summer I attempted to implement that into fxos-ports URL that is the place where I think it should be with some flags (adb=true)

.
#mozilla/node-firefox\issue-57097298\comment-82358589.json . 
I made a module for installing an app to all ADB connected devices:.
URL.

I am not 100% sure if that module is the right approach as it's very limited (BUT EFFECTIVE!) in what it does: pushing an app to devices.

The issue is that you have to run the port forwarding step before you get to connect to anything, and before you do that you need to enumerate the adb devices. Not sure if we want to hide all this, but am also not sure what would gaia need. Push just an app? @arcturus halp!

.
#mozilla/node-firefox\issue-57097298\comment-82375117.json . 
I was kind of scratching my head about this over the past week or so, too. But, my problem is that not all adb connected devices are FxOS devices. Some will be, you know, Android devices. This is especially annoying for Cordova, which is meant to work cross-platform. 

I started peeking inside the ADB Helper addon. It seems to speculatively connects to the forwarded port and tries to get the FxOS version from the debugging API. If that fails, then it ignores that device as FxOS. The annoyance with that, though, is you get the connection permission prompt on every device every time unless you disable it with WebIDE first.

So, inline-code will list things like this:.

block-code.

I guess another way to go is to keep a list of device names, but that just seems like a big dumb task.

I'm going to poke into the ADB Helper some more, because it seems to help WebIDE detect FxOS devices without throwing up permission screens

.
#mozilla/node-firefox\issue-57097298\comment-82381441.json . 
Oh, hey, so I think this is how ADB Helper does it:.

block-code.

That's a fun hack.

.
#mozilla/node-firefox\issue-57097298\comment-82399301.json . 
Hah, that is awesome.

.
#mozilla/node-firefox\issue-57097298\comment-82614494.json . 
I hadn't seen CyberAgent/adbkit until poking through sole/install-to-adb - very cool!

So, I think I could use that shell hack from ADB Helper to look up device IDs with a combo of listDevices and shell. Then, listForwards accepts device IDs - which can then discover pre-existing port forwards specifically to FxOS devices. And, wherever a forward hasn't been done, we can make one with adbkit's forward. 

Not sure about un-forwarding, though. Might not be all that necessary: If we can detect existing forwards, we reuse them. So, hopefully they won't pile up. I guess they'll all get cleaned up with the adb daemon dies?

I think I'll play with that stuff tonight / tomorrow morning. Just thinking aloud in this comment in case I forget how to computer or something

.
#mozilla/node-firefox\issue-57097298\comment-83068465.json . 
They do get cleaned up :) seems that adbkit picks them up where they were. Otherwise I would have ran out of ports already on my machine specially when running it with 10 phones!

.
#mozilla/node-firefox\issue-57097298\comment-83068699.json . 
For documentation we discussed on irc to have a inline-code module and a inline-code module. Les is going to look into that.

.
#mozilla/node-firefox\issue-57097298\comment-83186273.json . 
node-firefox-find-devices is a thing! And I also have my first PR in to implement it. Tonight or tomorrow, I tackle foward-devices

.
#mozilla/node-firefox\issue-57097298\comment-86645814.json . 
and URL is another thing! closing because you can now interact with ADB devices! \o/

.
#mozilla/node-firefox\issue-57097298\comment-86667667.json . 
:100:.

.
#mozilla/node-firefox\issue-57097298\issue-57097298.json . 
Right now we can just use the simulator if we want to use node-firefox modules, but gaia build system could get better if we can actually perform all this nice actions on real devices :)

.
#mozilla/node-firefox\issue-58641142\issue-58641142.json . 
Windows support should be working on find-ports, find-simulators, and start-simulators

.
#mozilla/node-firefox\issue-58641142\pr-29841114.json . 
Windows support should be working on find-ports, find-simulators, and start-simulators

.
#mozilla/node-firefox\issue-59686029\comment-77007603.json . 
Yes, this is awesome and our examples should encourage this usage. The localForage tests look SOOOO much nicer with this style of promises. +1!

.
#mozilla/node-firefox\issue-59686029\comment-77845150.json . 
Yes, also see URL which is related

.
#mozilla/node-firefox\issue-59686029\issue-59686029.json . 
Promises can be chained, rather than nested like callbacks. That makes code much cleaner. Here's a quick sample of dirty code I'm using to exercise modules:.

block-code.

I'll probably work through the various libraries and submit PRs myself. But, here's an issue filed just in case I don't get around to it.

.
#mozilla/node-firefox\issue-59719679\comment-77061369.json . 
Ah, thanks you! I recall this was caught someplace else but I guess not in
every module. Thanks!

-tofumatt
On 3 Mar 2015 22:45, "Bruno Garcia" notifications@github.com wrote:.



















.
#mozilla/node-firefox\issue-59719679\comment-77208792.json . 
This should be fixed. I'm going to try doing some full runs of the module stack on Linux later today / tomorrow, so that will expose any more we've missed.

.
#mozilla/node-firefox\issue-59719679\comment-77221174.json . 
Thanks for the quick fixes!

It looks like launch-app and uninstall-app still need updating.

.
#mozilla/node-firefox\issue-59719679\comment-77222671.json . 
Doh, premature close then :) Threw in a couple of PRs for those two...

URL.
URL.

.
#mozilla/node-firefox\issue-59719679\comment-77226367.json . 
Merged, so once these are released on npm we should close 

.
#mozilla/node-firefox\issue-59719679\comment-83128942.json . 
Just pushed updates to git and npm for all the modules!

.
#mozilla/node-firefox\issue-59719679\issue-59719679.json . 
Almost all of the node-firefox modules have lines like this:.

block-code.

This fails on case-sensitive filesystems (Linux). The correct case is es6-promise.

After I made all the replacements, things seem to work surprisingly well on Linux! You might be able to update your support matrix after this change. ;)

(Example: URL.

.
#mozilla/node-firefox\issue-59833630\comment-77273673.json . 
This appears relevant for @canuckistani 

.
#mozilla/node-firefox\issue-59833630\comment-77746436.json . 
I asked @canuckistani about this too. Heather left Mozilla a while ago but she has transferred ownership of a couple of repositories to Jeff. I don't think she would mind transferring this one-it would keep the code alive :-)

.
#mozilla/node-firefox\issue-59833630\comment-77935387.json . 
It's a little complicated - Firefox Client works right now ( I've been using it for some browser automatio and it's awesome! ). There is another client project with a smaller api called volcan that is a bit more flexible.
1. fork firefox-client somewhere, possibly into the /mozilla/ github org.
2. look at firefox-client as well as volcan and figure out what api we want. I thik the firefox-client api is pretty good, but could use some baked-in promises support ease the pain of making many many tab.DOM.\* calls.
3. look at all of the various bits of code lying around for starting up and configuring firefox processes in projects like firefox-client and jpm and deliver a key part of this: starting up a firefox process on a remote server with the right x11 environment that is listening for remote debugging connections on the specified port, so that libraries like firefox-client can connect to them and do things.

.
#mozilla/node-firefox\issue-59833630\comment-77935465.json . 
Also, tagging @Gozala in this thread as he is the authour of volcan.

.
#mozilla/node-firefox\issue-59833630\comment-82360021.json . 
1. I would suggest transferring the repo to mozilla. Don't fork it because then the issues end up in heather's repo, which is not maintained ;-)
2. maybe firefox-client could return both (promises+callbacks), or maybe a new version of firefox-client is not backwards compatible and only uses promises
3. this looks like a completely different project!

.
#mozilla/node-firefox\issue-59833630\comment-82598167.json . 


I think a complimentary and necessary one though. If I'm going to fully automate Firefox on a server for automation.

.
#mozilla/node-firefox\issue-59833630\comment-86095321.json . 
We kept hearing about Vulcan but it is released ? Does that work with webapps actor, or at least regular tab actors (console, style, debugger ??) ?
firefox-client works, is released for quite a while, bug-fixed, supports old version of Firefox OS and almost all actors if not all...
And node-firefox is already entangled with firefox-client.
So we would need serious arguments to move to it! Moving firefox-client into another github account and tweaking it to promises sounds way more pragmatic choice.

.
#mozilla/node-firefox\issue-59833630\comment-88243846.json . 
Sorry, this issue was brought up again in IRC by @digitarald and I realised we didn't really come to a conclusion here.

I think what makes sense is to build on Heather's work. It works for us and if we need to update it or add to it we can. Once that happens we push it to a Mozilla repo.

When we do this, we should update its codebase to simplify it a bit and bring it in-line with inline-code (Promises-only API, etc.)

I'll leave this open for now but I think the plan is to maintain our own version, though I'm gonna talk with @canuckistani more about this tomorrow morning and will update here then as well.

.
#mozilla/node-firefox\issue-59833630\comment-88247647.json . 
What would be great is to integrate firefox-client tests in our CI tools (treeherder).
That would make it fully supported by everyone and prevent regressing it.
I imagine that's something somewhat easy to do via taskcluster.

.
#mozilla/node-firefox\issue-59833630\issue-59833630.json . 
Looking at the firefox-client repo, there's a big inline-code in the description.

The last commit was back in Nov 2014. That seems not too long ago, though I'm not very clueful about the (in)stability of the Firefox dev APIs. Could be practically fine for a very long time.

But, assuming the worst, should we consider picking up maintenance of firefox-client? Or, maybe splitting off the bits used by the node-firefox suite?

.
#mozilla/node-firefox\issue-60675488\comment-78288265.json . 
SWEEEEEET :+1:.

.
#mozilla/node-firefox\issue-60675488\issue-60675488.json . 
Having run some scripts that exercise the whole listed stack of modules on Linux & Windows, I'll make the bold claim that all these boxes can be checked.

.
#mozilla/node-firefox\issue-60675488\pr-30953337.json . 
Having run some scripts that exercise the whole listed stack of modules on Linux & Windows, I'll make the bold claim that all these boxes can be checked.

.
#mozilla/node-firefox\issue-60696042\comment-78339263.json . 
Examples would be great, either of the errors or of ways to do this :smile: 

.
#mozilla/node-firefox\issue-60696042\issue-60696042.json . 
I see some grammar and spelling mistakes in the md files, it would be beneficial to have some grammar/spell checking done on these documents for each pull request with travis.

.
#mozilla/node-firefox\issue-60718163\comment-78355366.json . 
@tofumatt r?

.
#mozilla/node-firefox\issue-60718163\comment-78380365.json . 
That is... very cool! :+1: 

.
#mozilla/node-firefox\issue-60718163\comment-78390308.json . 
Small nitpick: The tests should have probably used nodeunit, since that's what we're using throughout the rest of the suite. (Though, I actually like mocha & chai better.)

.
#mozilla/node-firefox\issue-60718163\comment-78437267.json . 
Good point, I'll convert them over today.

-tofumatt
On 11 Mar 2015 22:52, "Les Orchard" notifications@github.com wrote:.









.
#mozilla/node-firefox\issue-60791788\comment-83075857.json . 
Belated "works for me" r+!

.
#mozilla/node-firefox\issue-60791788\issue-60791788.json . 
This doesn't seem to accurately check inline-code and I can't tell why. With the same code, inline-code works just fine (and it actually caught things that the other branch by @erikvold didn't, so I'm wondering if this were working exactly as intended?)

.
#mozilla/node-firefox\issue-60791788\pr-31019459.json . 
This doesn't seem to accurately check inline-code and I can't tell why. With the same code, inline-code works just fine (and it actually caught things that the other branch by @erikvold didn't, so I'm wondering if this were working exactly as intended?)

.
#mozilla/node-firefox\issue-63240435\issue-63240435.json . 
Related to @sole's question in URL which versions of Firefox OS do we consider our "minimum supported version"?

I would think it's 1.2, as a lot of things on 1.0/1.1 devices and simulators are not easy to control remotely. We should note that in a README, but it might be best to declare it for the whole project rather than in individual module's READMEs.

.
#mozilla/node-firefox\issue-63704853\issue-63704853.json . 
:wink: 

.
#mozilla/node-firefox\issue-63704853\pr-31725060.json . 
:wink: 

.
#mozilla/node-firefox\issue-64073442\comment-102457723.json . 
Going to call this done for now: URL.

But, I've also started working on a CLI tool: URL.

.
#mozilla/node-firefox\issue-64073442\comment-85659131.json . 
Yeah, I was actually looking at this sad, empty module earlier and thinking this would make sense.

I’m all for it and could do the grunt work later tonight :)

.
#mozilla/node-firefox\issue-64073442\comment-86644391.json . 
There's that option, or the option of having this module be a command line thing.

Or maybe that thing should be inline-code? o_O

.
#mozilla/node-firefox\issue-64073442\comment-86647912.json . 
This one could certainly ship with a CLI as well? Like, inline-code. inline-code would be a weird CLI script to have to type all the time.

-tofumatt

On 26 March 2015 at 18:52:13, sole (notifications@github.com) wrote:.

There's that option, or the option of having this module be a command line thing.

Or maybe that thing should be node-firefox-cli? o_O

—
Reply to this email directly or view it on GitHub.

.
#mozilla/node-firefox\issue-64073442\comment-86654251.json . 
I believe when you install grunt-cli you don't type grunt-cli but grunt ;)

.
#mozilla/node-firefox\issue-64073442\comment-86654691.json . 
Yeah, but I loathe that. It’s like inline-code and you get the binary inline-code. It’s super unexpected. :-(

.
#mozilla/node-firefox\issue-64073442\comment-86662418.json . 
you're actually right! and it's a thing that totally confused me with grunt. So let's not do this.

What about this - having this module do a module.exports but also _importing_ and running the cli/binary if installed globally

.
#mozilla/node-firefox\issue-64073442\comment-86662856.json . 
That plan sounds perfect to me!

.
#mozilla/node-firefox\issue-64073442\issue-64073442.json . 
What if node-firefox had an index.js like this?

block-code.

Then, a developer could just include inline-code in dependencies and use inline-code to make calls like inline-code. Or, even make shorter aliases like inline-code to cut down on redundant inline-codees everywhere.

.
#mozilla/node-firefox\issue-64606143\comment-86669150.json . 
+1 - I'm doing something similar over in cordova-firefoxos, and would be happy to delete most of that dumb code.

.
#mozilla/node-firefox\issue-64606143\comment-86685230.json . 
Hahaha, I see! I can confirm my code is working because I'm using it _all the time_ both via ADB and via various simulators.

.
#mozilla/node-firefox\issue-64606143\comment-86743706.json . 
For what it's worth, I think this syntactic sugar is worth adding too. Modules that combine things to make common tasks easier are awesome and if node-firefox is both a low and high level API I say that's great.
- tofumatt (Sent from mobile)

On 26 March 2015 20:35:40 CET, sole notifications@github.com wrote:Hahaha, I see! I can confirm my code is working because I'm using it all the time both via ADB and via various simulators.  —Reply to this email directly or view it on GitHub.               

.
#mozilla/node-firefox\issue-64606143\issue-64606143.json . 
This would be syntactic sugar on top of a bunch of existing modules. Not sure if you want this as a separate module but I'm using it a lot myself, so maybe there _is_ a need.

I actually have a version already here, push-app so we would just need to transfer repo and make it node-firefox quality :P with tests and all

.
#mozilla/node-firefox\issue-65339388\comment-87892780.json . 
It could possibly make sense to construct some kind of shared JS module for connection that can be used both by inline-code and in Gecko, so that features are available to both. However, this does not feel like a simple task. Just a thought.

.
#mozilla/node-firefox\issue-65339388\issue-65339388.json . 
FxOS has support for "bulk data" which allows apps to be installed roughly ~10x faster than the basic method.

Support for this is limited in external tools so far, but inline-code could certainly use it! Outside of Gecko directly, I am only aware of ffdb.py offering this support.

I believe it would require changes to how connections are managed, so most of the work may happen in inline-code, but perhaps other modules are impacted as well.

.
#mozilla/node-firefox\issue-65341296\comment-87966764.json . 
HA! I just came here to file a bug for this!

For doc purposes: here's @jryans post announcing this: URL.

So @jryans I was going to ask you if you could point me to where this is documented/explained in tech terms, past the QR code side etc. I guess there is lots of hand shaking between the two devices etc. It doesn't seem like it can be done automatically i.e. without human interaction, whereas I was expecting more of a Bonjour like approach so we could run "something" that would scan the network and find Firefox OS devices, then we could run "something else" that would try to connect, if successful we can do the QR dance, and then finally end up with a remote host:port and we can connect to it with firefox-client?

.
#mozilla/node-firefox\issue-65341296\comment-88271579.json . 
In fact, it is an automatic, Boujour-like approach. (What gives the impression that it is manual? I'd like to know, since I'm writing more posts about it! :smile:)

Devices are discovered automatically on the same Wi-Fi network. There is a design doc (also in-tree) which explains the authentication handshake protocol.

So, potentially inline-code (in some modules somewhere) would want to:.
1. Search for devices using the discovery mechanism
2. Run the client side of the handshake
3. Display a QR code for the phone to scan

After the first connection, it can really be automatic if you choose to remember the client.

Anyway, that's a lot of stuff to do... so, perhaps the code sharing is best? Not sure.

.
#mozilla/node-firefox\issue-65341296\issue-65341296.json . 
FxOS recently gained support for DevTools over Wi-Fi.

If inline-code was able to detect Wi-Fi devices and connect to them, that would be quite cool!

The code to do so in Gecko is a bit complex, though. Ideally, some code could be shared with Gecko to reduce duplication.

Multiple modules would be impacted, such as: inline-code and inline-code.

.
#mozilla/node-firefox\issue-68993376\comment-103650168.json . 
So, I just discovered that I can reliably make inline-code segfault on node v0.12.2 after I hit the "Reset and enable full DevTools" button in the Developer settings on my Flame. 

If I flash the device to a base image and _just_ turn on DevTools & ADB debugging, things work fine. Once I hit that "reset & enable" button again, the segfaults return.

No idea what could cause that, but it seems like handy additional info

.
#mozilla/node-firefox\issue-68993376\comment-103661325.json . 
I installed inline-code and plugged it into the inline-code stuff I'm working on.

This is what I get:.

block-code.

.
#mozilla/node-firefox\issue-68993376\comment-103662784.json . 
By tracing calls and puking inline-code all over the place, I tracked the segfault down to readMessage() in inline-code. But, from there, things get weird.

I "fixed" the segfault by adding a inline-code to inline-code like so:.

block-code.

That is, everything works fine with that inline-code in place. But, segfault returns when I comment it out. I suspect a bug in node / io.js, but not sure WTF is happening yet.

:confounded: 

.
#mozilla/node-firefox\issue-68993376\comment-103826811.json . 
This is the weirdest thing! and also you're amazingggg! I've no idea how to proceed further. Do you know if this happens in other systems? Just to discount if it's a Mac OS thing (?)

.
#mozilla/node-firefox\issue-68993376\comment-103970694.json . 
Haven't been able to confirm it happens on Windows or Linux. But, I _can_ confirm it does _not_ happen on node v0.10.38 on OS X, and it _does_ happen on v0.11.4 & beyond. Might happen earlier, but I don't have a minimal test case yet and versions earlier than v0.11.4 don't seem compatible with all the node-firefox dependencies (which is weird, but whatever)

Asked for help in #node.js on freenode IRC, and people seemed stumped & asked me to file an issue against node. :laughing: :crying_cat_face: 

.
#mozilla/node-firefox\issue-68993376\comment-103995850.json . 
Filed #25357 against node.js, based on a minimized test case.

So, I guess the best we can say at this point is don't use node-firefox with node>=0.11.0 on OS X

.
#mozilla/node-firefox\issue-68993376\comment-104001777.json . 
Isn't the right thing to do to look into a way around it until the upstream bug is resolved? Leaving the console.log in place feels dirty but there may be a less invasive way to get the same effect, eg calling process.nextTick or pumping the console's cursor forward and then back again.

.
#mozilla/node-firefox\issue-68993376\comment-104015851.json . 
Yeah, I'm actually looking into that... trying to come up with something that doesn't spew messages for every byte (or chunk) of network activity from the device.

FWIW, this also touches on #29, because the bug is triggered in firefox-client. Not the end of the world, because I can fork it and tweak all node-firefox modules to use the fork. But we may need to care for & feed that fork going forward. Also not a terrible thing.

.
#mozilla/node-firefox\issue-68993376\comment-104024437.json . 
Yeah, there might be a workaround. It's a magical accidental discovery and I have no idea why it works, but I can give it a shot in a fork of firefox-client

.
#mozilla/node-firefox\issue-68993376\comment-104370075.json . 
Crud. Workaround doesn't fix anything, just makes the problem more rare. So, it's exacerbated by more network activity because every chunk of data received has a chance of setting it off - i.e. I set up a small demo for myself with 2 devices and 2 simulators, fired off an install task against all of them, and the segfault returned.

.
#mozilla/node-firefox\issue-68993376\comment-94543428.json . 
So, I updated to node v0.12.2 via homebrew on OS X. Just started poking at a few modules and tests pass. I tried running a little script I've got that connects to a simulator and a device, and it worked fine to install and launch an app. 

Couldn't reproduce an issue, but I'm assuming that means I'm just missing it. Do you have some steps to reproduce where you ran into this, and also maybe a copypasta of the error trace you saw?

.
#mozilla/node-firefox\issue-68993376\comment-94547586.json . 
FWIW, I also downloaded io.js v1.7.1 binaries for OS X, and was able to install apps to a simulator and device without error.

.
#mozilla/node-firefox\issue-68993376\comment-94557961.json . 
thanks for looking into this! It was the examples in this repository: URL.

I should try to reproduce it but I'm busy with another thing and can't do it this week :-(

.
#mozilla/node-firefox\issue-68993376\issue-68993376.json . 
I have had reports of a few people saying this project doesn't work and they cannot install apps, but none of them filed a bug report (AHEM AHEM).

Later I updated a computer and decided to go all brave and install io.js and try node-firefox. And it didn't work. I tried with the latest node which happened to be 0.12 and it didn't work either. I had to roll back to 0.10 and it did work.

Because I did all this in a hurry I didn't keep any logs and I do not know what it was exactly other than a obscure trace coming from _somewhere_.

If someone could take a look at this it would be really appreciated. Even if it's just to find the root of the issue.

.
#mozilla/node-firefox\issue-76071992\comment-101771027.json . 
This should have been fixed with this PR: URL.

But, that wasn't published to npm. Having just done so, hopefully that fixed things.

.
#mozilla/node-firefox\issue-76071992\issue-76071992.json . 
Steps to reproduce:.
- write code that uses a block like this:.

block-code.
- replace the above with something like this:.

block-code.
- expected result: connection to device
- actual results: Error: connect EADDRNOTAVAIL followed by inability to connect to simulator after reverting the script 

.
#mozilla/node-firefox\issue-76498122\comment-102177845.json . 
:+1:.

.
#mozilla/node-firefox\issue-76498122\issue-76498122.json . 
Just an initial set of small changes to use node-firefox as a distribution module.

Thinking of expanding this to also come along with a CLI tool, but maybe itself as a separate repo. But, wanted to see how just adding the "table of contents" module worked at first.

.
#mozilla/node-firefox\issue-76498122\pr-35464763.json . 
Just an initial set of small changes to use node-firefox as a distribution module.

Thinking of expanding this to also come along with a CLI tool, but maybe itself as a separate repo. But, wanted to see how just adding the "table of contents" module worked at first.

.
#mozilla/node-firefox\issue-76498122\pr-comment-30366022.json . 
I would love to do this programatically based on the dependancies in the inline-code, but that can simply be a TODO :smile:  

.
#mozilla/node-firefox\issue-76498122\pr-comment-30366538.json . 
That's a good idea... I was thinking about doing it that way, but then had a feeling I shouldn't. 

In retrospect, I think that feeling was me remembering dynamic inline-code's don't work in Browserify. But, this isn't for Browserify, so that reticence is probably just superstition.

.
#mozilla/node-firefox\issue-92723232\comment-118160042.json . 
Thank you!

.
#mozilla/node-firefox\issue-92723232\issue-92723232.json . 
node_modules/node-firefox-find-app/index.js:var Promise = require('es6-Promise').Promise;
node_modules/node-firefox-stop-app/index.js:var Promise = require('es6-Promise').Promise;
node_modules/node-firefox-install-app/index.js:var Promise = require('es6-Promise').Promise;
node_modules/node-firefox-launch-app/index.js:var Promise = require('es6-Promise').Promise;

es6-promise is all lowercase in npm. Figured I'd file here than 4 times on the other projects.

.
