{"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/116388648", "pull_request_review_id": 38006702, "id": 116388648, "diff_hunk": "@@ -82,6 +72,10 @@ def season_params\n     )\n   end\n \n+  def phase\n+    params[:phase].to_sym if phase.in? PHASES", "path": "app/controllers/orga/seasons_controller.rb", "position": null, "original_position": 32, "commit_id": "4c120f41f14b541cf49d9fc05bb70c5382c8ba91", "original_commit_id": "021a433ee24bcbde6703dc0175c0f3070ed713ce", "user": {"login": "klappradla", "id": 3491815, "avatar_url": "https://avatars3.githubusercontent.com/u/3491815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klappradla", "html_url": "https://github.com/klappradla", "followers_url": "https://api.github.com/users/klappradla/followers", "following_url": "https://api.github.com/users/klappradla/following{/other_user}", "gists_url": "https://api.github.com/users/klappradla/gists{/gist_id}", "starred_url": "https://api.github.com/users/klappradla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klappradla/subscriptions", "organizations_url": "https://api.github.com/users/klappradla/orgs", "repos_url": "https://api.github.com/users/klappradla/repos", "events_url": "https://api.github.com/users/klappradla/events{/privacy}", "received_events_url": "https://api.github.com/users/klappradla/received_events", "type": "User", "site_admin": false}, "body": "As I said in a previous comment, since I think we can be sure to **always** be on a Ruby version > 2.2, we'll have GC for symbols. Therefore, no problem with DoS when converting strings to symbols in this case.\r\n\r\nI'd vote for removing the `if` condition here. I also cannot imagine it working *(`PHASES` is defined in a different namespace, would be `Season::PhaseSwitcher::PHASES`)*... plus I don't think it makes huge sense to first check wheather the param is whitelisted, if not, pass on nil and then check again if it's whitelisted.\r\n\r\nSo, I'd suggest to just go with:\r\n```ruby\r\ndef phase\r\n  params[:phase].to_sym\r\nend\r\n```\r\nand then to the whole whitelist stuff in the model where the actual business logic lies.", "created_at": "2017-05-14T19:22:19Z", "updated_at": "2017-05-14T21:21:53Z", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/585#discussion_r116388648", "pull_request_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/585", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/116388648"}, "html": {"href": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/585#discussion_r116388648"}, "pull_request": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/585"}}, "body_html": "<p>As I said in a previous comment, since I think we can be sure to <strong>always</strong> be on a Ruby version &gt; 2.2, we'll have GC for symbols. Therefore, no problem with DoS when converting strings to symbols in this case.</p>\n<p>I'd vote for removing the <code>if</code> condition here. I also cannot imagine it working <em>(<code>PHASES</code> is defined in a different namespace, would be <code>Season::PhaseSwitcher::PHASES</code>)</em>... plus I don't think it makes huge sense to first check wheather the param is whitelisted, if not, pass on nil and then check again if it's whitelisted.</p>\n<p>So, I'd suggest to just go with:</p>\n<div class=\"highlight highlight-source-ruby\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">phase</span>\n  params[<span class=\"pl-c1\">:phase</span>].to_sym\n<span class=\"pl-k\">end</span></pre></div>\n<p>and then to the whole whitelist stuff in the model where the actual business logic lies.</p>", "body_text": "As I said in a previous comment, since I think we can be sure to always be on a Ruby version > 2.2, we'll have GC for symbols. Therefore, no problem with DoS when converting strings to symbols in this case.\nI'd vote for removing the if condition here. I also cannot imagine it working (PHASES is defined in a different namespace, would be Season::PhaseSwitcher::PHASES)... plus I don't think it makes huge sense to first check wheather the param is whitelisted, if not, pass on nil and then check again if it's whitelisted.\nSo, I'd suggest to just go with:\ndef phase\n  params[:phase].to_sym\nend\nand then to the whole whitelist stuff in the model where the actual business logic lies."}