{"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/159122180", "pull_request_review_id": 86030045, "id": 159122180, "diff_hunk": "@@ -89,3 +89,24 @@ en:\n             attributes:\n               user:\n                 too_many_reviewers: too many reviewers\n+          application_draft:\n+            attributes:\n+              projects:\n+                too_many_selected: must not be selected twice\n+                none_accepted: must have been accepted\n+              base:\n+                too_many_applications: Only one application may be lodged\n+                unconfirmed_email_address: Please make sure every student confirmed the email address.\n+          conference:\n+            attributes:\n+              ends_on:\n+                chronology_violation: must be a later date than start date\n+          team:\n+            attributes:\n+              roles:\n+                too_many_students: there cannot be more than 2 students on a team.", "path": "config/locales/en.yml", "position": 19, "original_position": 19, "commit_id": "9dba120d284b9571bab6b50e8c20472d41c08328", "original_commit_id": "9dba120d284b9571bab6b50e8c20472d41c08328", "user": {"login": "F3PiX", "id": 6314687, "avatar_url": "https://avatars1.githubusercontent.com/u/6314687?v=4", "gravatar_id": "", "url": "https://api.github.com/users/F3PiX", "html_url": "https://github.com/F3PiX", "followers_url": "https://api.github.com/users/F3PiX/followers", "following_url": "https://api.github.com/users/F3PiX/following{/other_user}", "gists_url": "https://api.github.com/users/F3PiX/gists{/gist_id}", "starred_url": "https://api.github.com/users/F3PiX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/F3PiX/subscriptions", "organizations_url": "https://api.github.com/users/F3PiX/orgs", "repos_url": "https://api.github.com/users/F3PiX/repos", "events_url": "https://api.github.com/users/F3PiX/events{/privacy}", "received_events_url": "https://api.github.com/users/F3PiX/received_events", "type": "User", "site_admin": false}, "body": "For the team, two base errors are missing here. (line 175 and 183)\r\nhttps://github.com/rails-girls-summer-of-code/rgsoc-teams/blob/a020e98eb1339e29170fdb7e7c64404fe0719b2c/app/models/team.rb#L165-L184\r\n\r\nIt is a bit more challenging than the other errors. Are you up to that?\r\n", "created_at": "2017-12-30T12:53:44Z", "updated_at": "2017-12-30T12:53:44Z", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/899#discussion_r159122180", "pull_request_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/899", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/159122180"}, "html": {"href": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/899#discussion_r159122180"}, "pull_request": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/899"}}, "body_html": "<p>For the team, two base errors are missing here. (line 175 and 183)<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails-girls-summer-of-code/rgsoc-teams/blob/a020e98eb1339e29170fdb7e7c64404fe0719b2c/app/models/team.rb#L165-L184\">rgsoc-teams/app/models/team.rb</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n        Lines 165 to 184\n      in\n      <a href=\"/rails-girls-summer-of-code/rgsoc-teams/commit/a020e98eb1339e29170fdb7e7c64404fe0719b2c\" class=\"commit-tease-sha\" data-pjax=\"true\">a020e98</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L165\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"165\"></td>\n          <td id=\"LC165\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-c1\">MSGS</span> <span class=\"pl-k\">=</span> { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L166\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"166\"></td>\n          <td id=\"LC166\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   <span class=\"pl-c1\">duplicate_student_roles_singular:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>%s already is a student on another team for <span class=\"pl-pse\">#{</span><span class=\"pl-s1\"><span class=\"pl-c1\">Season</span>.current.name</span><span class=\"pl-pse\">}</span>.<span class=\"pl-pds\">\"</span></span>, </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L167\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"167\"></td>\n          <td id=\"LC167\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   <span class=\"pl-c1\">duplicate_student_roles_plural:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>%s already are students on another team for <span class=\"pl-pse\">#{</span><span class=\"pl-s1\"><span class=\"pl-c1\">Season</span>.current.name</span><span class=\"pl-pse\">}</span>.<span class=\"pl-pds\">\"</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L168\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"168\"></td>\n          <td id=\"LC168\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> } </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L169\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"169\"></td>\n          <td id=\"LC169\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L170\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"170\"></td>\n          <td id=\"LC170\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">disallow_multiple_student_roles</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L171\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"171\"></td>\n          <td id=\"LC171\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   students <span class=\"pl-k\">=</span> <span class=\"pl-c1\">User</span>.with_role(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>student<span class=\"pl-pds\">'</span></span>).joins(<span class=\"pl-c1\">roles:</span> <span class=\"pl-c1\">:team</span>).where(<span class=\"pl-c1\">id:</span> roles.map(<span class=\"pl-k\">&amp;</span><span class=\"pl-c1\">:user_id</span>)). </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L172\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"172\"></td>\n          <td id=\"LC172\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">     where.not(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>roles.team_id<span class=\"pl-pds\">'</span></span> =&gt; id).where(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>teams.season_id<span class=\"pl-pds\">'</span></span> =&gt; season_id) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L173\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"173\"></td>\n          <td id=\"LC173\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   <span class=\"pl-k\">return</span> <span class=\"pl-k\">if</span> students.empty? </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L174\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"174\"></td>\n          <td id=\"LC174\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   msg <span class=\"pl-k\">=</span> <span class=\"pl-c1\">MSGS</span>[<span class=\"pl-c1\">:\"duplicate_student_roles_<span class=\"pl-pse\">#{</span><span class=\"pl-s1\">students.size <span class=\"pl-k\">==</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">?</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>singular<span class=\"pl-pds\">'</span></span> : <span class=\"pl-s\"><span class=\"pl-pds\">'</span>plural<span class=\"pl-pds\">'</span></span></span><span class=\"pl-pse\">}</span>\"</span>] </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L175\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"175\"></td>\n          <td id=\"LC175\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   errors.add <span class=\"pl-c1\">:base</span>, msg <span class=\"pl-k\">%</span> students.map(<span class=\"pl-k\">&amp;</span><span class=\"pl-c1\">:name</span>).join(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>, <span class=\"pl-pds\">'</span></span>) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L176\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"176\"></td>\n          <td id=\"LC176\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L177\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"177\"></td>\n          <td id=\"LC177\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L178\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"178\"></td>\n          <td id=\"LC178\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">disallow_duplicate_members</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L179\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"179\"></td>\n          <td id=\"LC179\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   new_members <span class=\"pl-k\">=</span> roles.map { |<span class=\"pl-smi\">role</span>| role.user } </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L180\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"180\"></td>\n          <td id=\"LC180\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   duplicate_role_users <span class=\"pl-k\">=</span> new_members.find_all { |<span class=\"pl-smi\">member</span>| new_members.count(member) <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">1</span> }.uniq </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L181\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"181\"></td>\n          <td id=\"LC181\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   <span class=\"pl-k\">return</span> <span class=\"pl-k\">if</span> duplicate_role_users.empty? </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L182\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"182\"></td>\n          <td id=\"LC182\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   msg <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>%s can't have more than one role in this team!<span class=\"pl-pds\">\"</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L183\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"183\"></td>\n          <td id=\"LC183\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   errors.add <span class=\"pl-c1\">:base</span>, msg <span class=\"pl-k\">%</span> duplicate_role_users.map(<span class=\"pl-k\">&amp;</span><span class=\"pl-c1\">:name</span>).join(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>, <span class=\"pl-pds\">'</span></span>) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L184\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"184\"></td>\n          <td id=\"LC184\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p>It is a bit more challenging than the other errors. Are you up to that?</p>", "body_text": "For the team, two base errors are missing here. (line 175 and 183)\n\n  \n    \n      rgsoc-teams/app/models/team.rb\n    \n    \n        Lines 165 to 184\n      in\n      a020e98\n    \n    \n    \n    \n\n        \n          \n           MSGS = { \n        \n\n        \n          \n             duplicate_student_roles_singular: \"%s already is a student on another team for #{Season.current.name}.\", \n        \n\n        \n          \n             duplicate_student_roles_plural: \"%s already are students on another team for #{Season.current.name}.\" \n        \n\n        \n          \n           } \n        \n\n        \n          \n            \n        \n\n        \n          \n           def disallow_multiple_student_roles \n        \n\n        \n          \n             students = User.with_role('student').joins(roles: :team).where(id: roles.map(&:user_id)). \n        \n\n        \n          \n               where.not('roles.team_id' => id).where('teams.season_id' => season_id) \n        \n\n        \n          \n             return if students.empty? \n        \n\n        \n          \n             msg = MSGS[:\"duplicate_student_roles_#{students.size == 1 ? 'singular' : 'plural'}\"] \n        \n\n        \n          \n             errors.add :base, msg % students.map(&:name).join(', ') \n        \n\n        \n          \n           end \n        \n\n        \n          \n            \n        \n\n        \n          \n           def disallow_duplicate_members \n        \n\n        \n          \n             new_members = roles.map { |role| role.user } \n        \n\n        \n          \n             duplicate_role_users = new_members.find_all { |member| new_members.count(member) > 1 }.uniq \n        \n\n        \n          \n             return if duplicate_role_users.empty? \n        \n\n        \n          \n             msg = \"%s can't have more than one role in this team!\" \n        \n\n        \n          \n             errors.add :base, msg % duplicate_role_users.map(&:name).join(', ') \n        \n\n        \n          \n           end \n        \n    \n  \n\n\nIt is a bit more challenging than the other errors. Are you up to that?"}