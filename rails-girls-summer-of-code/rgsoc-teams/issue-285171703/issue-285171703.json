{"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/900", "repository_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams", "labels_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/900/labels{/name}", "comments_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/900/comments", "events_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/900/events", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/900", "id": 285171703, "number": 900, "title": "Don't show a \"my team\" button to guest users / users without a team", "user": {"login": "klappradla", "id": 3491815, "avatar_url": "https://avatars3.githubusercontent.com/u/3491815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klappradla", "html_url": "https://github.com/klappradla", "followers_url": "https://api.github.com/users/klappradla/followers", "following_url": "https://api.github.com/users/klappradla/following{/other_user}", "gists_url": "https://api.github.com/users/klappradla/gists{/gist_id}", "starred_url": "https://api.github.com/users/klappradla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klappradla/subscriptions", "organizations_url": "https://api.github.com/users/klappradla/orgs", "repos_url": "https://api.github.com/users/klappradla/repos", "events_url": "https://api.github.com/users/klappradla/events{/privacy}", "received_events_url": "https://api.github.com/users/klappradla/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-12-30T00:06:43Z", "updated_at": "2017-12-31T18:35:27Z", "closed_at": "2017-12-31T18:35:25Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/900", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/900", "diff_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/900.diff", "patch_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/900.patch"}, "body_html": "<p>This fixes a bug on the team index page (likely only visible in production): both guest users and users who aren't students or part of a team see a <code>my team</code> button which will bring them to the show view for some random team where at least one student deleted their account <strong>(we should try to avoid getting these invalid team records in the first place...)</strong></p>\n<p>Looked like this <em>(see I'm not signed in)</em>:<br>\n<a href=\"https://user-images.githubusercontent.com/3491815/34449833-58abba90-ecfd-11e7-837e-9a9c2aaaeb65.png\" target=\"_blank\"><img width=\"1792\" alt=\"screen shot 2017-12-28 at 12 22 03\" src=\"https://user-images.githubusercontent.com/3491815/34449833-58abba90-ecfd-11e7-837e-9a9c2aaaeb65.png\" style=\"max-width:100%;\"></a></p>\n<p>Tiny bit of background: the <code>current_student</code> helper defined in the <code>ApplicationController</code> would always return a <code>Student</code>, even if there's no <code>current_user</code> (the student would then be called <code>nil</code>) and would therefore always find a <code>current_team</code> - one with a <code>user_id</code> being nil.</p>", "body_text": "This fixes a bug on the team index page (likely only visible in production): both guest users and users who aren't students or part of a team see a my team button which will bring them to the show view for some random team where at least one student deleted their account (we should try to avoid getting these invalid team records in the first place...)\nLooked like this (see I'm not signed in):\n\nTiny bit of background: the current_student helper defined in the ApplicationController would always return a Student, even if there's no current_user (the student would then be called nil) and would therefore always find a current_team - one with a user_id being nil.", "body": "This fixes a bug on the team index page (likely only visible in production): both guest users and users who aren't students or part of a team see a `my team` button which will bring them to the show view for some random team where at least one student deleted their account **(we should try to avoid getting these invalid team records in the first place...)**\r\n\r\nLooked like this _(see I'm not signed in)_:\r\n<img width=\"1792\" alt=\"screen shot 2017-12-28 at 12 22 03\" src=\"https://user-images.githubusercontent.com/3491815/34449833-58abba90-ecfd-11e7-837e-9a9c2aaaeb65.png\">\r\n\r\nTiny bit of background: the `current_student` helper defined in the `ApplicationController` would always return a `Student`, even if there's no `current_user` (the student would then be called `nil`) and would therefore always find a `current_team` - one with a `user_id` being nil."}