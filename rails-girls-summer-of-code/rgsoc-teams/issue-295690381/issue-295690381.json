{"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/928", "repository_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams", "labels_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/928/labels{/name}", "comments_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/928/comments", "events_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/issues/928/events", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/928", "id": 295690381, "number": 928, "title": "Cleanup sending email after submitting an application", "user": {"login": "klappradla", "id": 3491815, "avatar_url": "https://avatars3.githubusercontent.com/u/3491815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klappradla", "html_url": "https://github.com/klappradla", "followers_url": "https://api.github.com/users/klappradla/followers", "following_url": "https://api.github.com/users/klappradla/following{/other_user}", "gists_url": "https://api.github.com/users/klappradla/gists{/gist_id}", "starred_url": "https://api.github.com/users/klappradla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klappradla/subscriptions", "organizations_url": "https://api.github.com/users/klappradla/orgs", "repos_url": "https://api.github.com/users/klappradla/repos", "events_url": "https://api.github.com/users/klappradla/events{/privacy}", "received_events_url": "https://api.github.com/users/klappradla/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-02-08T22:36:10Z", "updated_at": "2018-02-09T11:52:04Z", "closed_at": "2018-02-09T11:52:04Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/928", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/928", "diff_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/928.diff", "patch_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/928.patch"}, "body_html": "<p>As said in <a href=\"https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/917\" class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"292232364\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/rails-girls-summer-of-code/rgsoc-teams/issues/917\">#917</a> <em>(and mention in a comment by <a href=\"https://github.com/carpodaster\" class=\"user-mention\">@carpodaster</a>)</em>: creating an <code>Application</code> from an <code>ApplicationDraft</code> and then sending out emails to both submitters and the orga team could / should be done in the <code>ApplicationDraft</code> model instead of the controller.</p>\n<p>This PR moves all the callback-logic related to an <code>ApplicationDraft</code> moving from <code>draft</code> to <code>applied</code> into the already existing state machine in the <code>ApplicationDraft</code> model.<br>\nI as a small drive-by-refactoring\u2122 also moved <code>CreatesApplicationFromDraft</code> into a <code>service</code>. I just think having this a a \"callable\" object makes the usage and intention a bit more obvious.</p>", "body_text": "As said in #917 (and mention in a comment by @carpodaster): creating an Application from an ApplicationDraft and then sending out emails to both submitters and the orga team could / should be done in the ApplicationDraft model instead of the controller.\nThis PR moves all the callback-logic related to an ApplicationDraft moving from draft to applied into the already existing state machine in the ApplicationDraft model.\nI as a small drive-by-refactoring\u2122 also moved CreatesApplicationFromDraft into a service. I just think having this a a \"callable\" object makes the usage and intention a bit more obvious.", "body": "As said in https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/917 _(and mention in a comment by @carpodaster)_: creating an `Application` from an `ApplicationDraft` and then sending out emails to both submitters and the orga team could / should be done in the `ApplicationDraft` model instead of the controller.\r\n\r\nThis PR moves all the callback-logic related to an `ApplicationDraft` moving from `draft` to `applied` into the already existing state machine in the `ApplicationDraft` model.\r\nI as a small drive-by-refactoring\u2122 also moved `CreatesApplicationFromDraft` into a `service`. I just think having this a a \"callable\" object makes the usage and intention a bit more obvious."}