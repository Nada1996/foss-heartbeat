{"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/20410063", "pull_request_review_id": null, "id": 20410063, "diff_hunk": "@@ -0,0 +1,124 @@\n+class FormApplicationsController < ApplicationController\n+  include ApplicationsHelper\n+\n+  before_filter :checktime, only: [:new, :create]\n+  before_action :set_application,  only: [:show, :edit, :update, :destroy]\n+\n+  respond_to :html\n+\n+def index\n+  @form_applications = FormApplication.all\n+end\n+\n+  def new\n+    if signed_in?\n+      @form_application  = FormApplication.new\n+    else\n+      render 'applications/sign_in'\n+    end\n+  end\n+\n+  def show\n+\n+  end\n+\n+  def create\n+    if params[:apply_off]\n+      @application = current_user.applications.create!(application_params)\n+      @form_application.update_attributes({submitted: true})\n+      ApplicationFormMailerWorker.new.async.perform(application_id: @application.id)\n+      @application\n+      render 'applications/create'\n+    else\n+     @form_application = FormApplication.new(form_application_params)\n+       respond_to do |format|\n+         if @form_application.save\n+           format.html { redirect_to @form_application, notice: 'Application was successfully created.' }\n+           format.json { render action: :show, status: :created, location: @form_application }\n+         else\n+           format.html { render action: :new }\n+           format.json { render json: @form_application.errors, status: :unprocessable_entity }\n+         end\n+       end\n+   end\n+    end\n+\n+\n+  def edit\n+    if @form_application.submitted\n+      @form_application = FormApplication.find(params[:id])\n+      render 'submit_form'\n+    else\n+      render 'edit'\n+    end\n+  end\n+\n+  def update\n+   if params[:apply_off]\n+   @application = current_user.applications.create!(application_params)\n+   @form_application.update_attributes({submitted: true})\n+   ApplicationFormMailerWorker.new.async.perform(application_id: @application.id)\n+   @application\n+   render 'applications/create'\n+   else\n+    respond_to do |format|\n+      if @form_application.update_attributes(form_application_params)\n+        format.html { redirect_to @form_application, notice: 'Application was successfully updated.' }\n+        format.json { head :no_content }\n+      else\n+        format.html { render action: :edit }\n+        format.json { render json: @form_application.errors, status: :unprocessable_entity }\n+      end\n+    end\n+   end\n+   end\n+\n+  def destroy\n+    @form_application.destroy\n+    respond_to do |format|\n+      format.html { redirect_to form_applications_url }\n+      format.json { head :no_content }\n+    end\n+  end\n+\n+  private\n+\n+  def form_application\n+    @form_application ||= FormApplication.new(form_application_params)\n+  end\n+\n+  def set_application\n+   @form_application = FormApplication.find(params[:id])\n+  end\n+\n+  def checktime\n+    if Time.now.utc >= Time.utc(2014, 5, 2, 23, 59)\n+      render 'applications/ended'\n+    end\n+  end\n+\n+  def application\n+    @application ||= Application.new\n+  end\n+\n+\n+  def form_application_params\n+    params.require(:form_application).permit(*FormApplication::FIELDS)\n+  end\n+\n+  def application_params\n+    {\n+        name: form_application.name,\n+        email: form_application.email,\n+        application_data: form_application.serializable_hash\n+    }\n+  end\n+\n+  def applications", "path": "app/controllers/form_applications_controller.rb", "position": 117, "original_position": 117, "commit_id": "1161123a4ec78624b2090407c892255688c2df36", "original_commit_id": "8ee26c88ed08ce876e6fe50624632f84f9fd3ac0", "user": {"login": "AkshataDM", "id": 6331843, "avatar_url": "https://avatars1.githubusercontent.com/u/6331843?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AkshataDM", "html_url": "https://github.com/AkshataDM", "followers_url": "https://api.github.com/users/AkshataDM/followers", "following_url": "https://api.github.com/users/AkshataDM/following{/other_user}", "gists_url": "https://api.github.com/users/AkshataDM/gists{/gist_id}", "starred_url": "https://api.github.com/users/AkshataDM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AkshataDM/subscriptions", "organizations_url": "https://api.github.com/users/AkshataDM/orgs", "repos_url": "https://api.github.com/users/AkshataDM/repos", "events_url": "https://api.github.com/users/AkshataDM/events{/privacy}", "received_events_url": "https://api.github.com/users/AkshataDM/received_events", "type": "User", "site_admin": false}, "body": "When an application is being submitted in the create and update actions \n", "created_at": "2014-11-16T14:55:05Z", "updated_at": "2014-12-14T13:50:48Z", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/123#discussion_r20410063", "pull_request_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/123", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/20410063"}, "html": {"href": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/123#discussion_r20410063"}, "pull_request": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/123"}}, "body_html": "<p>When an application is being submitted in the create and update actions</p>", "body_text": "When an application is being submitted in the create and update actions"}