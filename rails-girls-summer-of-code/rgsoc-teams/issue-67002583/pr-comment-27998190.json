{"url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/27998190", "pull_request_review_id": null, "id": 27998190, "diff_hunk": "@@ -111,14 +122,20 @@ def ensure_max_applications\n     end\n   end\n \n+  def require_student\n+    unless application_draft.as_student?\n+      redirect_to application_drafts_path, alert: 'You must be listed as a student on your team'\n+    end\n+  end\n+\n   def current_team\n-    current_student.current_team || coaches_team\n+    current_student.current_team || extended_team\n   end\n \n-  def coaches_team\n-    @coaches_team ||= begin\n+  def extended_team", "path": "app/controllers/application_drafts_controller.rb", "position": 42, "original_position": 42, "commit_id": "069000b4cb50827aa5675953fdccea3f90493540", "original_commit_id": "e46a6babf07fd13a9241af00bc5b9607d7ae239c", "user": {"login": "carpodaster", "id": 164400, "avatar_url": "https://avatars2.githubusercontent.com/u/164400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carpodaster", "html_url": "https://github.com/carpodaster", "followers_url": "https://api.github.com/users/carpodaster/followers", "following_url": "https://api.github.com/users/carpodaster/following{/other_user}", "gists_url": "https://api.github.com/users/carpodaster/gists{/gist_id}", "starred_url": "https://api.github.com/users/carpodaster/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carpodaster/subscriptions", "organizations_url": "https://api.github.com/users/carpodaster/orgs", "repos_url": "https://api.github.com/users/carpodaster/repos", "events_url": "https://api.github.com/users/carpodaster/events{/privacy}", "received_events_url": "https://api.github.com/users/carpodaster/received_events", "type": "User", "site_admin": false}, "body": "We don't set the team explicitely and instead retrieve it via the `ApplicationDraft` instance (which we find with `params[:id]`). This method (together with `current_team` in line 131) wants to make sure that the team is discarded when the currently logged in user is not part of that team and that we have no start of the association chain when `application_draft` is looked up in line 71.\n\n>  could we consider a refactor?\n\nBy all means YES. However, I would very much like to do this after this functional PR if you think this method does what it is supposed to do (see above).\n", "created_at": "2015-04-08T18:24:10Z", "updated_at": "2015-04-08T18:24:10Z", "html_url": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/188#discussion_r27998190", "pull_request_url": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/188", "author_association": "OWNER", "_links": {"self": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/comments/27998190"}, "html": {"href": "https://github.com/rails-girls-summer-of-code/rgsoc-teams/pull/188#discussion_r27998190"}, "pull_request": {"href": "https://api.github.com/repos/rails-girls-summer-of-code/rgsoc-teams/pulls/188"}}, "body_html": "<p>We don't set the team explicitely and instead retrieve it via the <code>ApplicationDraft</code> instance (which we find with <code>params[:id]</code>). This method (together with <code>current_team</code> in line 131) wants to make sure that the team is discarded when the currently logged in user is not part of that team and that we have no start of the association chain when <code>application_draft</code> is looked up in line 71.</p>\n<blockquote>\n<p>could we consider a refactor?</p>\n</blockquote>\n<p>By all means YES. However, I would very much like to do this after this functional PR if you think this method does what it is supposed to do (see above).</p>", "body_text": "We don't set the team explicitely and instead retrieve it via the ApplicationDraft instance (which we find with params[:id]). This method (together with current_team in line 131) wants to make sure that the team is discarded when the currently logged in user is not part of that team and that we have no start of the association chain when application_draft is looked up in line 71.\n\ncould we consider a refactor?\n\nBy all means YES. However, I would very much like to do this after this functional PR if you think this method does what it is supposed to do (see above)."}